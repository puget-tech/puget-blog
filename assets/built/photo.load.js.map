{"version":3,"sources":["photo.load.js"],"names":["jQuery","document","ready","$","hide","length","fancybox","nextEffect","openEffect","closeEffect","prevEffect","ajax","url","interpolate","hostname","window","location","host","type","data","action","post_id","photo_load","mym_post_id","success","resp","console","log","imgList","parseJSON","html","imageObj","sets","Array","set","i","j","push","mymPhotoLoader","queueSets","addSets","setIndex","loadedCue","that","this","index","each","e","find","remove","end","insertAfter","bind","group","setTimeout","String","prototype","replace","placeholder","property"],"mappings":"AAAAA,OAAOC,UAAUC,MAAM,WAErBC,EAAE,qBAAqBC,OAGM,EAA3BD,EAAE,gBAAgBE,QACpBF,EAAE,gBAAgBG,SAAS,CAC1BC,WAAa,OACbC,WAAa,OACbC,YAAc,OACdC,WAAa,SAKfP,EAAEQ,KAAK,CACJC,IAAK,8CAA8CC,YAAY,CAACC,SAASC,OAAOC,SAASC,OACzFC,KAAM,OACNC,KAAM,CACLC,OAAQ,iBACPC,QAASC,WAAWC,aAGxBC,QAAS,SAASC,GAEdC,QAAQC,IAAIF,GAeb,IAdF,IAAIG,EAAU5B,OAAO6B,UAAUJ,GAE3BK,EAAO,GAGPC,EAAW,KAGXC,EAAO,IAAIC,MAGXC,EAAM/B,IAGCgC,EAAI,EAAIA,EAAIP,EAAQvB,OAAS,EAAI8B,GAAI,EAAG,CAClDD,EAAM,GACJ,IAAM,IAAIE,EAAID,EAAIC,EAAID,EAAE,EAAIC,KAC3BL,EAAYH,EAAQQ,GAAMR,EAAQQ,GAAK,QAGxCN,EAnBY,0MAmBIjB,YAAYkB,GAC5BG,EAAIG,KAAKP,IAKTE,EAAKK,KAAKH,GAIb/B,EAAEmC,eAAeC,UAAUP,GAE3B7B,EAAEmC,eAAeE,aAInBxC,OAAOsC,eAAiB,CAEvBN,KAAM,GACNS,SAAW,EACXC,UAAW,EAEXF,QAAU,WACT,IAAIG,EAAOC,KACPC,EAAQD,KAAKH,SACbP,EAAMU,KAAKZ,KAAKa,GAEjBX,GACF/B,EAAE2C,KAAKZ,EAAK,SAASC,EAAGY,GACvB5C,EAAE4C,GAAGC,KAAK,0BAA0BC,SAASC,MAAMC,YAAY,sBAAsBH,KAAK,OAAOI,KAAK,OAAQ,WAC7GT,EAAKD,WAAa,EACI,IAAnBC,EAAKD,YACPC,EAAKD,UAAY,EACjBC,EAAKF,UAAY,EAGhBtC,EAAEG,SAAS+C,MAAQlD,EAAE,gBACtBmD,WAAW,WAAWX,EAAKH,WAAY,WAO5CD,UAAY,SAASP,GACpBY,KAAKZ,KAAOA,MAUfuB,OAAOC,UAAU3C,YAAc,SAASM,GACvC,OAAOyB,KAAKa,QAAQ,iBAAkB,SAASC,EAAaC,GAC3D,OAAOxC,EAAKwC","file":"photo.load.js","sourcesContent":["jQuery(document).ready(function(){\r\n\r\n  $('#no-js-more-photo').hide();\r\n\r\n\t//initialize fancybox on existing thumbs\r\n\tif($(\".thumb-group\").length > 0){\r\n\t\t$(\".thumb-group\").fancybox({\r\n\t\t\tnextEffect : 'fade',\r\n\t\t\topenEffect : 'fade',\r\n\t\t\tcloseEffect : 'fade',\r\n\t\t\tprevEffect : 'fade'\r\n\t\t});\r\n\t}\r\n\r\n\t//load additional thumbs via ajax request\r\n\t$.ajax({\r\n    url: \"http://{{hostname}}/wp-admin/admin-ajax.php\".interpolate({hostname:window.location.host}),\r\n    type: \"POST\",\r\n    data: {\r\n\t    action: 'mym_photo_load',\r\n      post_id: photo_load.mym_post_id\r\n    },\r\n\r\n\t\tsuccess: function(resp) {\r\n\t\t\t//collection of image objects to append to gallery\r\n      console.log(resp);\r\n\t\t\tvar imgList = jQuery.parseJSON(resp);\r\n\t\t\tvar template = \"<div class='gallery-item'><a href='{{full}}' class='thumb-group' rel='gallery' title='{{caption}}'><img class='gallery-thumb' src='{{thumb}}'/><div class='gallery-caption'>{{caption}}</div></a></div>\";\r\n\t\t\tvar html = '';\r\n\r\n\t\t\t//single image from list\r\n\t\t\tvar imageObj = null;\r\n\r\n\t\t\t//collection of sets of 5\r\n\t\t\tvar sets = new Array();\r\n\r\n\t\t\t//single set (will be set of 5 els)\r\n\t\t\tvar set = $();\r\n\r\n\t\t\t//create a single set of five, and push to the collection\r\n\t    for( var i = 0 ; i - imgList.length < 1 ; i +=5 ){\r\n\t\t\t\tset = [];\r\n\t\t    for ( var j = i ; j < i+5 ; j++ ){\r\n\t\t\t    imageObj = (imgList[j]) ? imgList[j] : null;\r\n\r\n\t\t\t\t\tif(imageObj){\r\n\t\t\t\t\t\thtml = template.interpolate(imageObj);\r\n\t\t\t\t\t\tset.push(html);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t    //push the set of five to the collection of sets\r\n\t\t    sets.push(set);\r\n\t    }\r\n\r\n\t\t\t//pass the entire collection to mymPhotoLoader\r\n\t\t\t$.mymPhotoLoader.queueSets(sets);\r\n\t\t\t//append the els to the document\r\n\t\t\t$.mymPhotoLoader.addSets();\r\n    }\r\n\t});//ajax success function\r\n\r\n\tjQuery.mymPhotoLoader = {\r\n\r\n\t\tsets: [],\r\n\t\tsetIndex : 0,\r\n\t\tloadedCue: 0,\r\n\r\n\t\taddSets : function(){\r\n\t\t\tvar that = this;\r\n\t\t\tvar index = this.setIndex;\r\n\t\t\tvar set = this.sets[index];\r\n\r\n\t\t\tif(set){\r\n\t\t\t\t$.each(set, function(i, e){\r\n\t\t\t\t\t$(e).find('.gallery-caption:empty').remove().end().insertAfter('.gallery-item:last').find('img').bind('load', function(){\r\n\t\t\t\t\t\tthat.loadedCue += 1;\r\n\t\t\t\t\t\tif(that.loadedCue === 5){\r\n\t\t\t\t\t\t\tthat.loadedCue = 0;\r\n\t\t\t\t\t\t\tthat.setIndex += 1;\r\n\r\n\t\t\t\t\t\t\t//reset the fancybox gallery to include newly added thumbs\r\n\t\t\t\t\t\t\t\t$.fancybox.group = $('.thumb-group');\r\n\t\t\t\t\t\t\tsetTimeout(function(){that.addSets()}, 100);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tqueueSets : function(sets){\r\n\t\t\tthis.sets = sets;\r\n\t\t}\r\n\r\n\t};\r\n});//document ready\r\n\r\n\r\n//string example:  hello {{name}}\r\n//obj data:      data.name = world;\r\n//output:   example.interpolate(data) returns hello world;\r\nString.prototype.interpolate = function(data){\r\n\treturn this.replace(/\\{\\{(\\S+)\\}\\}/g, function(placeholder, property){\r\n\t\treturn data[property];\r\n\t});\r\n};"],"sourceRoot":"/source/"}